<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1400 800">
  <defs>
    <marker id="arrow" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
      <path d="M0,0 L8,4 L0,8 L2,4 Z" fill="#546E7A"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1400" height="800" fill="#FFFFFF"/>

  <!-- Title -->
  <text x="700" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#222222">ROS 2 Node Graph - Simplified</text>
  <text x="700" y="55" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#666666">Key Nodes and Topic Connections</text>

  <!-- ============ NODES (Ellipses) ============ -->
  
  <!-- Gazebo -->
  <ellipse cx="120" cy="200" rx="90" ry="35" fill="#E3F2FD" stroke="#1976D2" stroke-width="2"/>
  <text x="120" y="195" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#1565C0">gz_sim</text>
  <text x="120" y="210" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666666">(Gazebo)</text>

  <!-- ros_gz_bridge nodes -->
  <ellipse cx="320" cy="120" rx="80" ry="30" fill="#FFF3E0" stroke="#FF9800" stroke-width="2"/>
  <text x="320" y="125" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#E65100">lidar_bridge</text>

  <ellipse cx="320" cy="200" rx="80" ry="30" fill="#FFF3E0" stroke="#FF9800" stroke-width="2"/>
  <text x="320" y="205" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#E65100">imu_bridge</text>

  <ellipse cx="320" cy="280" rx="80" ry="30" fill="#FFF3E0" stroke="#FF9800" stroke-width="2"/>
  <text x="320" y="285" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#E65100">clock_bridge</text>

  <!-- TwistStamper -->
  <ellipse cx="320" cy="550" rx="85" ry="30" fill="#FFF3E0" stroke="#FF9800" stroke-width="2"/>
  <text x="320" y="555" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#E65100">twist_to_stamped</text>

  <!-- robot_state_publisher -->
  <ellipse cx="120" cy="400" rx="100" ry="30" fill="#E8EAF6" stroke="#5C6BC0" stroke-width="2"/>
  <text x="120" y="405" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#3949AB">robot_state_publisher</text>

  <!-- Controller Manager (inside Gazebo) -->
  <ellipse cx="120" cy="550" rx="105" ry="35" fill="#F3E5F5" stroke="#9C27B0" stroke-width="2"/>
  <text x="120" y="545" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#7B1FA2">ackermann_steering</text>
  <text x="120" y="560" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#7B1FA2">_controller</text>

  <!-- EKF -->
  <ellipse cx="540" cy="200" rx="80" ry="35" fill="#E8F5E9" stroke="#4CAF50" stroke-width="2"/>
  <text x="540" y="195" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#2E7D32">ekf_imu_odom</text>
  <text x="540" y="210" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666666">(EKF)</text>

  <!-- SLAM -->
  <ellipse cx="540" cy="350" rx="80" ry="35" fill="#E8F5E9" stroke="#4CAF50" stroke-width="2"/>
  <text x="540" y="345" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#2E7D32">slam_toolbox</text>
  <text x="540" y="360" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666666">(Localization)</text>

  <!-- Nav2 Nodes -->
  <ellipse cx="780" cy="120" rx="90" ry="30" fill="#FCE4EC" stroke="#E91E63" stroke-width="2"/>
  <text x="780" y="125" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#C2185B">bt_navigator</text>

  <ellipse cx="780" cy="200" rx="90" ry="30" fill="#FCE4EC" stroke="#E91E63" stroke-width="2"/>
  <text x="780" y="205" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#C2185B">planner_server</text>

  <ellipse cx="780" cy="280" rx="90" ry="30" fill="#FCE4EC" stroke="#E91E63" stroke-width="2"/>
  <text x="780" y="285" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#C2185B">controller_server</text>

  <ellipse cx="780" cy="360" rx="90" ry="30" fill="#FCE4EC" stroke="#E91E63" stroke-width="2"/>
  <text x="780" y="365" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#C2185B">smoother_server</text>

  <ellipse cx="780" cy="440" rx="90" ry="30" fill="#FCE4EC" stroke="#E91E63" stroke-width="2"/>
  <text x="780" y="445" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#C2185B">behavior_server</text>

  <ellipse cx="1020" cy="200" rx="100" ry="30" fill="#FCE4EC" stroke="#E91E63" stroke-width="2"/>
  <text x="1020" y="205" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#C2185B">global_costmap</text>

  <ellipse cx="1020" cy="280" rx="100" ry="30" fill="#FCE4EC" stroke="#E91E63" stroke-width="2"/>
  <text x="1020" y="285" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#C2185B">local_costmap</text>

  <ellipse cx="1020" cy="360" rx="100" ry="30" fill="#FCE4EC" stroke="#E91E63" stroke-width="2"/>
  <text x="1020" y="365" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#C2185B">velocity_smoother</text>

  <!-- Lifecycle Manager -->
  <ellipse cx="1020" cy="120" rx="100" ry="30" fill="#ECEFF1" stroke="#607D8B" stroke-width="2"/>
  <text x="1020" y="125" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#455A64">lifecycle_manager</text>

  <!-- RViz -->
  <ellipse cx="1250" cy="300" rx="70" ry="35" fill="#E0F7FA" stroke="#00BCD4" stroke-width="2"/>
  <text x="1250" y="305" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#00838F">rviz2</text>

  <!-- ============ TOPICS (Rectangles) ============ -->
  
  <!-- /scan -->
  <rect x="390" y="100" width="60" height="25" rx="3" ry="3" fill="#BBDEFB" stroke="#1976D2" stroke-width="1.5"/>
  <text x="420" y="117" text-anchor="middle" font-family="monospace" font-size="9" fill="#1565C0">/scan</text>

  <!-- /imu -->
  <rect x="405" y="185" width="50" height="25" rx="3" ry="3" fill="#BBDEFB" stroke="#1976D2" stroke-width="1.5"/>
  <text x="430" y="202" text-anchor="middle" font-family="monospace" font-size="9" fill="#1565C0">/imu</text>

  <!-- /clock -->
  <rect x="395" y="265" width="55" height="25" rx="3" ry="3" fill="#BBDEFB" stroke="#1976D2" stroke-width="1.5"/>
  <text x="422" y="282" text-anchor="middle" font-family="monospace" font-size="9" fill="#1565C0">/clock</text>

  <!-- /odom -->
  <rect x="240" cy="480" width="55" height="25" rx="3" ry="3" fill="#E1BEE7" stroke="#9C27B0" stroke-width="1.5"/>
  <text x="267" y="497" text-anchor="middle" font-family="monospace" font-size="9" fill="#7B1FA2">/odom</text>

  <!-- /odometry/filtered -->
  <rect x="600" y="260" width="110" height="25" rx="3" ry="3" fill="#C8E6C9" stroke="#4CAF50" stroke-width="1.5"/>
  <text x="655" y="277" text-anchor="middle" font-family="monospace" font-size="8" fill="#2E7D32">/odometry/filtered</text>

  <!-- /map -->
  <rect x="600" y="400" width="50" height="25" rx="3" ry="3" fill="#C8E6C9" stroke="#4CAF50" stroke-width="1.5"/>
  <text x="625" y="417" text-anchor="middle" font-family="monospace" font-size="9" fill="#2E7D32">/map</text>

  <!-- /cmd_vel -->
  <rect x="500" y="535" width="70" height="25" rx="3" ry="3" fill="#FFCDD2" stroke="#E91E63" stroke-width="1.5"/>
  <text x="535" y="552" text-anchor="middle" font-family="monospace" font-size="9" fill="#C2185B">/cmd_vel</text>

  <!-- /reference -->
  <rect x="200" y="615" width="160" height="25" rx="3" ry="3" fill="#E1BEE7" stroke="#9C27B0" stroke-width="1.5"/>
  <text x="280" y="632" text-anchor="middle" font-family="monospace" font-size="8" fill="#7B1FA2">/ackermann.../reference</text>

  <!-- /tf -->
  <rect x="600" y="480" width="40" height="25" rx="3" ry="3" fill="#ECEFF1" stroke="#607D8B" stroke-width="1.5"/>
  <text x="620" y="497" text-anchor="middle" font-family="monospace" font-size="9" fill="#455A64">/tf</text>

  <!-- /robot_description -->
  <rect x="200" y="385" width="120" height="25" rx="3" ry="3" fill="#E8EAF6" stroke="#5C6BC0" stroke-width="1.5"/>
  <text x="260" y="402" text-anchor="middle" font-family="monospace" font-size="8" fill="#3949AB">/robot_description</text>

  <!-- /plan -->
  <rect x="870" y="185" width="50" height="25" rx="3" ry="3" fill="#FFCDD2" stroke="#E91E63" stroke-width="1.5"/>
  <text x="895" y="202" text-anchor="middle" font-family="monospace" font-size="9" fill="#C2185B">/plan</text>

  <!-- ============ CONNECTIONS (Lines with arrows) ============ -->
  
  <!-- Gazebo to bridges -->
  <line x1="210" y1="200" x2="240" y2="120" stroke="#546E7A" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="210" y1="200" x2="240" y2="200" stroke="#546E7A" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="210" y1="200" x2="240" y2="280" stroke="#546E7A" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Bridges to topics -->
  <line x1="400" y1="120" x2="390" y2="112" stroke="#546E7A" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="400" y1="200" x2="405" y2="197" stroke="#546E7A" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="400" y1="280" x2="395" y2="277" stroke="#546E7A" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- /scan to SLAM and costmaps -->
  <line x1="450" y1="112" x2="480" y2="330" stroke="#1976D2" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="450" y1="112" x2="920" y2="200" stroke="#1976D2" stroke-width="1.5" stroke-dasharray="4,2" marker-end="url(#arrow)"/>
  <line x1="450" y1="112" x2="920" y2="280" stroke="#1976D2" stroke-width="1.5" stroke-dasharray="4,2" marker-end="url(#arrow)"/>

  <!-- /imu to EKF -->
  <line x1="455" y1="197" x2="460" y2="200" stroke="#1976D2" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Controller to /odom -->
  <line x1="120" y1="515" x2="240" y2="492" stroke="#9C27B0" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- /odom to EKF -->
  <line x1="295" y1="480" x2="460" y2="215" stroke="#9C27B0" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- EKF to /odometry/filtered -->
  <line x1="540" y1="235" x2="600" y2="272" stroke="#4CAF50" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- /odometry/filtered to Nav2 -->
  <line x1="710" y1="272" x2="780" y2="250" stroke="#4CAF50" stroke-width="1.5" stroke-dasharray="4,2" marker-end="url(#arrow)"/>

  <!-- SLAM to /map -->
  <line x1="540" y1="385" x2="600" y2="412" stroke="#4CAF50" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- SLAM to /tf -->
  <line x1="540" y1="385" x2="600" y2="492" stroke="#607D8B" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- /map to costmaps -->
  <line x1="650" y1="412" x2="920" y2="200" stroke="#4CAF50" stroke-width="1.5" stroke-dasharray="4,2" marker-end="url(#arrow)"/>
  <line x1="650" y1="412" x2="920" y2="280" stroke="#4CAF50" stroke-width="1.5" stroke-dasharray="4,2" marker-end="url(#arrow)"/>

  <!-- controller_server to /cmd_vel -->
  <line x1="780" y1="310" x2="570" y2="547" stroke="#E91E63" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- /cmd_vel to stamper -->
  <line x1="500" y1="547" x2="405" y2="550" stroke="#E91E63" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- stamper to /reference -->
  <line x1="320" y1="580" x2="280" y2="615" stroke="#FF9800" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- /reference to controller -->
  <line x1="200" y1="627" x2="120" y2="585" stroke="#9C27B0" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- planner to /plan -->
  <line x1="870" y1="200" x2="870" y2="197" stroke="#E91E63" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- robot_state_publisher to /robot_description -->
  <line x1="120" y1="370" x2="200" y2="397" stroke="#5C6BC0" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- /tf to rviz -->
  <line x1="640" y1="492" x2="1180" y2="300" stroke="#607D8B" stroke-width="1" stroke-dasharray="3,2"/>

  <!-- ============ LEGEND ============ -->
  <rect x="30" y="680" width="1340" height="90" rx="6" ry="6" fill="#FAFAFA" stroke="#E0E0E0" stroke-width="1"/>
  <text x="60" y="705" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#424242">Legend</text>

  <!-- Node types -->
  <ellipse cx="80" cy="735" rx="35" ry="15" fill="#E3F2FD" stroke="#1976D2" stroke-width="1.5"/>
  <text x="130" y="740" font-family="Arial, sans-serif" font-size="10" fill="#444444">Simulation</text>

  <ellipse cx="230" cy="735" rx="35" ry="15" fill="#FFF3E0" stroke="#FF9800" stroke-width="1.5"/>
  <text x="280" y="740" font-family="Arial, sans-serif" font-size="10" fill="#444444">Bridges</text>

  <ellipse cx="370" cy="735" rx="35" ry="15" fill="#F3E5F5" stroke="#9C27B0" stroke-width="1.5"/>
  <text x="420" y="740" font-family="Arial, sans-serif" font-size="10" fill="#444444">Control</text>

  <ellipse cx="510" cy="735" rx="35" ry="15" fill="#E8F5E9" stroke="#4CAF50" stroke-width="1.5"/>
  <text x="560" y="740" font-family="Arial, sans-serif" font-size="10" fill="#444444">Localization</text>

  <ellipse cx="670" cy="735" rx="35" ry="15" fill="#FCE4EC" stroke="#E91E63" stroke-width="1.5"/>
  <text x="720" y="740" font-family="Arial, sans-serif" font-size="10" fill="#444444">Navigation</text>

  <!-- Topic types -->
  <rect x="820" y="720" width="50" height="18" rx="3" ry="3" fill="#BBDEFB" stroke="#1976D2" stroke-width="1"/>
  <text x="885" y="733" font-family="Arial, sans-serif" font-size="10" fill="#444444">Sensor Topic</text>

  <rect x="970" y="720" width="50" height="18" rx="3" ry="3" fill="#C8E6C9" stroke="#4CAF50" stroke-width="1"/>
  <text x="1035" y="733" font-family="Arial, sans-serif" font-size="10" fill="#444444">Localization Topic</text>

  <rect x="1150" y="720" width="50" height="18" rx="3" ry="3" fill="#FFCDD2" stroke="#E91E63" stroke-width="1"/>
  <text x="1215" y="733" font-family="Arial, sans-serif" font-size="10" fill="#444444">Nav Topic</text>

  <!-- Connection types -->
  <line x1="830" y1="755" x2="870" y2="755" stroke="#546E7A" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="885" y="760" font-family="Arial, sans-serif" font-size="10" fill="#444444">Direct</text>

  <line x1="970" y1="755" x2="1010" y2="755" stroke="#546E7A" stroke-width="1.5" stroke-dasharray="4,2" marker-end="url(#arrow)"/>
  <text x="1025" y="760" font-family="Arial, sans-serif" font-size="10" fill="#444444">Subscribed</text>

</svg>

